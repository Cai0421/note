# T-CONV

在本文中，我们提出了将轨迹建模为二维图像的T-CONV，并采用多层卷积神经网络结合多尺度轨迹模式以实现精确的预测。此外，我们进行梯度分析以可视化T-CONV捕获的多尺度空间模式，并提取对最终预测有明显影响的区域。最后，我们整合了多个局部增强卷积场，以深入探索这些重要领域，以进行更好的预测。

**传统的目的地预测**：最近提出的一些模型通过使用马尔可夫模型将查询轨迹与历史记录相匹配来预测目的地，或者根据运动对象的轨迹聚类并根据相似对象的移动性模式进行预测。

1. 为了进行准确的预测，T-CONV将轨迹建模为二维图像，并采用多层卷积神经网络来组合多尺度二维轨迹特征。与传统的一维轨迹模型相比，T-CONV更清晰，更有效地捕获了不同空间尺度上的二维局部模式。
2. 为了可视化T-CONV捕获的多尺度模式，分析了特征的梯度分布，结果表明T-CONV可以在其较低的卷积层中有效地学习小规模的轨迹模式，并且将它们组合成更高层次的大规模模式。可视化还显示，靠近输入轨迹的起点和终点的部分对其最终目的地的预测有明显的影响。
3. 除了对整个输入轨迹进行卷积以外，我们还进一步在T-CONV中集成了多个局部增强卷积场，以进一步探索轨迹图像中的特定重要区域，这不仅可以减少轨迹数据集中的稀疏性问题，而且还可以大大提高了预测的准确性。

## 问题定义

对于出租车$T_i$而言，轨迹序列可以表示为
$$
\zeta_{i,j} = <\delta_{i,j,1},\delta_{i,j,2},...,\delta_{i,j,N_{i,j}}>
$$

$$
\delta_{i,j,k} = (\Phi_{i,j,k},\Upsilon_{i,j,k})(1\leq k \leq N_{i,j})
$$

其中$\Phi_{i,j,k},\Upsilon_{i,j,k}$代表经纬度

预测问题：给定出租车$T_i$以及对应的轨迹$\zeta_{i,j}$得到最终的目的地$\Theta(\zeta_{i,j})$

## 多尺度下的轨迹区别

![image-20210130135911999](C:\Users\CRUN\AppData\Roaming\Typora\typora-user-images\image-20210130135911999.png)

轨迹也具有显着的多尺度属性：在不同的空间尺度中，轨迹可以表现出不同的二维模式。图2显示了不同比例的滑行轨迹的典型示例。虚线表示从标有“ O”的位置开始行驶的滑行车的轨迹$\zeta_{i,j}$。图中的其他轨迹是训练集中的历史轨迹。图2（a）显示了最高分辨率的原始轨迹。
当处理不同比例的轨迹时，网格是将地图划分并将属于同一像元的空间点合并为一个不可分割的单元的常用工具。图2（b）显示了具有密集网格的微观空间尺度，其中以精细的粒度记录了轨迹。在这种比例下，轨迹视图显示了其运动模式的大多数细节，并且轨迹的重叠度很低，这在执行轨迹匹配时会导致稀疏性问题。当我们将地图划分为稀疏网格时，我们可以在更大的空间比例上说明轨迹，如图2（c）所示。在这种规模下，轨迹的重叠增加，并且移动物体的整体趋势更易于捕获。轨迹被分为两个类，根据这些类，出租车的目的地很有可能看起来像是“ x”。

## 模型部分

对于路网进行划分为$M*M$的网格，其中一网格记作$C_{m,n}$，对于其中一轨迹来说网格的数值可以记作![image-20210130140607756](C:\Users\CRUN\AppData\Roaming\Typora\typora-user-images\image-20210130140607756.png)

基于设置的T-CONV的模型为

![image-20210130140704357](C:\Users\CRUN\AppData\Roaming\Typora\typora-user-images\image-20210130140704357.png)

即利用多层CNN进行提取特征后，利用softmax函数进行分类，后提取特征后进行计算概率。

**梯度可视化**

对于相关的特征贡献，采用梯度的方式进行可视化的展示

![image-20210130141509298](C:\Users\CRUN\AppData\Roaming\Typora\typora-user-images\image-20210130141509298.png)

图4（b）显示了层L2可以捕获小规模模式，这些模式集中在小局部区域的详细变化上。同时，图4（a）示出了较高层L 4可以将较低级别的小规模图案组合成较大规模的有效图案。此外，图4中的红色和粗体区域对应于较大的渐变，并指示图案中的重要部分。从图4（a）中，有趣的是，经过训练的T-CONV模型可以“识别”出靠近轨迹起点和终点的局部区域对目的地预测的贡献更大。直觉上，轨迹的末端部分很重要，因为它最靠近目的地，并且揭示了轨迹的最新趋势。同时，轨迹的开始部分也很重要，因为它表明了客户来自何处，并代表了旅行的一些内在动机。

![image-20210130141637195](C:\Users\CRUN\AppData\Roaming\Typora\typora-user-images\image-20210130141637195.png)

## 局部增强模型

基于观察到轨迹的起点和终点附近的局部部分对目的地预测起着更为重要的作用，我们可以对这些局部区域进行深层卷积，而不必在全局图像上进行卷积。下图显示了该模型的体系结构，该模型集中于以输入轨迹的起点和终点为中心的两个局部区域。

![image-20210130142016008](C:\Users\CRUN\AppData\Roaming\Typora\typora-user-images\image-20210130142016008.png)

## 结果

测量这些模型的评估误差是实际目的地与预测位置之间的Haversine距离。距离定义为：
$$
d(x,y) = 2·r·arctan(\sqrt{\frac{a}{1-a}})
$$
![image-20210130142414497](C:\Users\CRUN\AppData\Roaming\Typora\typora-user-images\image-20210130142414497.png)



## 总结和展望部分

竞争 协同

该文采用了多尺度的CNN的方式，从而对于不同尺度的特征进行分别提取，结合额外信息获取最终的预测目的地。

并且基于此的基础上提出了局部增强的方式。

总的来说，对于目的点的预测是对于轨迹模式相似性的探索，文中通过CNN的方式对这种特征进行提取。

**问题**：

1. 能否通过将CNN置换成GCN的方式进行进一步的提取（多尺度GCN能否解决

2. 数据的方式采用的是格网还是正常道路路段方式
3. 数据是否存在稀疏问题
4. ETA嵌入部分

对于ETA部分，ETA的估计涉及到相关的空间信息、时间信息以及相关的轨迹信息，能否在该模块中进行相关的嵌入

